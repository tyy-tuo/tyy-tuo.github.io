function whenDOMReady(){"/essay/"==location.pathname&&document.addEventListener("DOMContentLoaded",(function(){setTimeout((()=>{changeTime(),btf.loadLightbox(document.querySelectorAll("#icat-bber img")),window.lazyLoadInstance&&window.lazyLoadInstance.update(),reflashWaterFall()}),300)}))}function timeDiff(e,t){const n=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()),a=Date.UTC(t.getFullYear(),t.getMonth(),t.getDate())-n;return Math.floor(a/864e5)}function changeTime(){const e=Array.from(document.getElementsByTagName("time")),t=new Date;e.forEach((e=>{const n=e.getAttribute("datetime"),a=new Date(n),l=timeDiff(a,t);let o;o=0===l?"最近":1===l?"昨天":2===l?"前天":l<=7?`${l}天前`:a.getFullYear()!==t.getFullYear()?`${a.getFullYear()}/${a.getMonth()+1}/${a.getDate()}`:`${a.getMonth()+1}/${a.getDate()}`,e.textContent=o}))}function reflashWaterFall(){document.querySelector("#waterfall")&&setTimeout((function(){waterfall("#waterfall"),document.getElementById("waterfall").classList.add("show")}),500)}function commentText(e){const t=["#wl-edit",".el-textarea__inner"];for(let n=0;n<t.length;n++){let a=document.querySelector(t[n]);null!=a&&(a.dispatchEvent(new Event("input",{bubble:!0,cancelable:!0})),a.value="> "+e.replace(/\n/g,"\n> ")+"\n\n",a.focus(),a.setSelectionRange(-1,-1))}}whenDOMReady(),document.addEventListener("pjax:complete",whenDOMReady),window.onresize=()=>{waterfall("#waterfall")};